
<!DOCTYPE html>
<html>
<head>

<meta charset="UTF-8">

<title>
    Bandit Report
</title>

<style>

html * {
    font-family: "Arial", sans-serif;
}

pre {
    font-family: "Monaco", monospace;
}

.bordered-box {
    border: 1px solid black;
    padding-top:.5em;
    padding-bottom:.5em;
    padding-left:1em;
}

.metrics-box {
    font-size: 1.1em;
    line-height: 130%;
}

.metrics-title {
    font-size: 1.5em;
    font-weight: 500;
    margin-bottom: .25em;
}

.issue-description {
    font-size: 1.3em;
    font-weight: 500;
}

.candidate-issues {
    margin-left: 2em;
    border-left: solid 1px; LightGray;
    padding-left: 5%;
    margin-top: .2em;
    margin-bottom: .2em;
}

.issue-block {
    border: 1px solid LightGray;
    padding-left: .5em;
    padding-top: .5em;
    padding-bottom: .5em;
    margin-bottom: .5em;
}

.issue-sev-high {
    background-color: Pink;
}

.issue-sev-medium {
    background-color: NavajoWhite;
}

.issue-sev-low {
    background-color: LightCyan;
}

</style>
</head>

<body>

<div id="metrics">
    <div class="metrics-box bordered-box">
        <div class="metrics-title">
            Metrics:<br>
        </div>
        Total lines of code: <span id="loc">48040</span><br>
        Total lines skipped (#nosec): <span id="nosec">0</span>
    </div>
</div>




<br>
<div id="results">
    
<div id="issue-0">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/cloudgoat.py" target="_blank">cloudgoat/cloudgoat.py</a><br>
    <b>Line number: </b>6<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
5	import re
6	import subprocess
7	import sys
</pre>
</div>


</div>
</div>

<div id="issue-1">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/cloudgoat.py" target="_blank">cloudgoat/cloudgoat.py</a><br>
    <b>Line number: </b>89<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
88	    try:
89	        terraform_version_process = subprocess.Popen(
90	            [&quot;terraform&quot;, &quot;--version&quot;], stdout=subprocess.PIPE
91	        )
92	    except FileNotFoundError:
</pre>
</div>


</div>
</div>

<div id="issue-2">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/cloudgoat.py" target="_blank">cloudgoat/cloudgoat.py</a><br>
    <b>Line number: </b>89<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
88	    try:
89	        terraform_version_process = subprocess.Popen(
90	            [&quot;terraform&quot;, &quot;--version&quot;], stdout=subprocess.PIPE
91	        )
92	    except FileNotFoundError:
</pre>
</div>


</div>
</div>

<div id="issue-3">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/core/python/commands.py" target="_blank">cloudgoat/core/python/commands.py</a><br>
    <b>Line number: </b>4<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
3	import shutil
4	import subprocess
5	import json
</pre>
</div>


</div>
</div>

<div id="issue-4">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/core/python/commands.py" target="_blank">cloudgoat/core/python/commands.py</a><br>
    <b>Line number: </b>371<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
370	            print(f&quot;\nNow running {scenario_name}&#x27;s start.sh...&quot;)
371	            start_script_process = subprocess.Popen(
372	                [&quot;sh&quot;, &quot;start.sh&quot;], cwd=instance_path
373	            )
374	            start_script_process.wait()
</pre>
</div>


</div>
</div>

<div id="issue-5">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/core/python/commands.py" target="_blank">cloudgoat/core/python/commands.py</a><br>
    <b>Line number: </b>371<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
370	            print(f&quot;\nNow running {scenario_name}&#x27;s start.sh...&quot;)
371	            start_script_process = subprocess.Popen(
372	                [&quot;sh&quot;, &quot;start.sh&quot;], cwd=instance_path
373	            )
374	            start_script_process.wait()
</pre>
</div>


</div>
</div>

<div id="issue-6">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/core/python/python_terraform/__init__.py" target="_blank">cloudgoat/core/python/python_terraform/__init__.py</a><br>
    <b>Line number: </b>4<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
3	
4	import subprocess
5	import os
</pre>
</div>


</div>
</div>

<div id="issue-7">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/core/python/python_terraform/__init__.py" target="_blank">cloudgoat/core/python/python_terraform/__init__.py</a><br>
    <b>Line number: </b>302<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
301	
302	        p = subprocess.Popen(cmds, stdout=stdout, stderr=stderr,
303	                             cwd=working_folder, env=environ_vars)
304	
</pre>
</div>


</div>
</div>

<div id="issue-8">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_tmp_directory: </b> Probable insecure usage of temp file/directory.<br>
    <b>Test ID:</b> B108<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/377.html" target="_blank">CWE-377</a><br>
    <b>File: </b><a href="cloudgoat/core/python/tests.py" target="_blank">cloudgoat/core/python/tests.py</a><br>
    <b>Line number: </b>228<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b108_hardcoded_tmp_directory.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b108_hardcoded_tmp_directory.html</a><br>

<div class="code">
<pre>
227	        core.python.utils.dirs_at_location = unittest.mock.Mock(return_value=[
228	            &#x27;/tmp/other_scenario_takeover_cgid5o8kwrb5ir&#x27;,
229	            &#x27;/tmp/ecs_takeover_cgidkcjqvxvjh8&#x27;,
230	        ])
231	        self.assertEqual(
232	            find_scenario_instance_dir(&#x27;/tmp&#x27;, &#x27;ecs_takeover&#x27;),
</pre>
</div>


</div>
</div>

<div id="issue-9">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_tmp_directory: </b> Probable insecure usage of temp file/directory.<br>
    <b>Test ID:</b> B108<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/377.html" target="_blank">CWE-377</a><br>
    <b>File: </b><a href="cloudgoat/core/python/tests.py" target="_blank">cloudgoat/core/python/tests.py</a><br>
    <b>Line number: </b>229<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b108_hardcoded_tmp_directory.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b108_hardcoded_tmp_directory.html</a><br>

<div class="code">
<pre>
228	            &#x27;/tmp/other_scenario_takeover_cgid5o8kwrb5ir&#x27;,
229	            &#x27;/tmp/ecs_takeover_cgidkcjqvxvjh8&#x27;,
230	        ])
231	        self.assertEqual(
232	            find_scenario_instance_dir(&#x27;/tmp&#x27;, &#x27;ecs_takeover&#x27;),
233	            &#x27;/tmp/ecs_takeover_cgidkcjqvxvjh8&#x27;,
</pre>
</div>


</div>
</div>

<div id="issue-10">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_tmp_directory: </b> Probable insecure usage of temp file/directory.<br>
    <b>Test ID:</b> B108<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/377.html" target="_blank">CWE-377</a><br>
    <b>File: </b><a href="cloudgoat/core/python/tests.py" target="_blank">cloudgoat/core/python/tests.py</a><br>
    <b>Line number: </b>232<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b108_hardcoded_tmp_directory.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b108_hardcoded_tmp_directory.html</a><br>

<div class="code">
<pre>
231	        self.assertEqual(
232	            find_scenario_instance_dir(&#x27;/tmp&#x27;, &#x27;ecs_takeover&#x27;),
233	            &#x27;/tmp/ecs_takeover_cgidkcjqvxvjh8&#x27;,
</pre>
</div>


</div>
</div>

<div id="issue-11">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_tmp_directory: </b> Probable insecure usage of temp file/directory.<br>
    <b>Test ID:</b> B108<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/377.html" target="_blank">CWE-377</a><br>
    <b>File: </b><a href="cloudgoat/core/python/tests.py" target="_blank">cloudgoat/core/python/tests.py</a><br>
    <b>Line number: </b>233<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b108_hardcoded_tmp_directory.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b108_hardcoded_tmp_directory.html</a><br>

<div class="code">
<pre>
232	            find_scenario_instance_dir(&#x27;/tmp&#x27;, &#x27;ecs_takeover&#x27;),
233	            &#x27;/tmp/ecs_takeover_cgidkcjqvxvjh8&#x27;,
234	        )
235	        core.python.utils.dirs_at_location.assert_called_with(&#x27;/tmp&#x27;)
236	
237	
</pre>
</div>


</div>
</div>

<div id="issue-12">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_tmp_directory: </b> Probable insecure usage of temp file/directory.<br>
    <b>Test ID:</b> B108<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/377.html" target="_blank">CWE-377</a><br>
    <b>File: </b><a href="cloudgoat/core/python/tests.py" target="_blank">cloudgoat/core/python/tests.py</a><br>
    <b>Line number: </b>235<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b108_hardcoded_tmp_directory.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b108_hardcoded_tmp_directory.html</a><br>

<div class="code">
<pre>
234	        )
235	        core.python.utils.dirs_at_location.assert_called_with(&#x27;/tmp&#x27;)
236	
</pre>
</div>


</div>
</div>

<div id="issue-13">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/core/python/tests/test_test.py" target="_blank">cloudgoat/core/python/tests/test_test.py</a><br>
    <b>Line number: </b>23<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
22	def test_test():
23	    assert True == True
</pre>
</div>


</div>
</div>

<div id="issue-14">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/core/python/utils.py" target="_blank">cloudgoat/core/python/utils.py</a><br>
    <b>Line number: </b>6<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
5	import string
6	import subprocess
7	import socket
</pre>
</div>


</div>
</div>

<div id="issue-15">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="cloudgoat/core/python/utils.py" target="_blank">cloudgoat/core/python/utils.py</a><br>
    <b>Line number: </b>45<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
44	
45	    res = requests.get(&quot;https://ifconfig.co/json&quot;)
46	    if res.status_code != 200:
</pre>
</div>


</div>
</div>

<div id="issue-16">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Standard pseudo-random generators are not suitable for security/cryptographic purposes.<br>
    <b>Test ID:</b> B311<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/330.html" target="_blank">CWE-330</a><br>
    <b>File: </b><a href="cloudgoat/core/python/utils.py" target="_blank">cloudgoat/core/python/utils.py</a><br>
    <b>Line number: </b>139<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b311-random" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b311-random</a><br>

<div class="code">
<pre>
138	    return &quot;cgid&quot; + &quot;&quot;.join(
139	        random.choice(string.ascii_lowercase + string.digits) for x in range(10)
140	    )
</pre>
</div>


</div>
</div>

<div id="issue-17">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.<br>
    <b>Test ID:</b> B310<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/22.html" target="_blank">CWE-22</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/sqs_flag_shop/assets/lambda_function.py" target="_blank">cloudgoat/scenarios/sqs_flag_shop/assets/lambda_function.py</a><br>
    <b>Line number: </b>20<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b310-urllib-urlopen" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b310-urllib-urlopen</a><br>

<div class="code">
<pre>
19	            req = urllib.request.Request(url, data=data_json, headers={&#x27;content-type&#x27;: &#x27;application/json&#x27;})
20	            res = urllib.request.urlopen(req)
21	            return &quot;Message sent to EC2 server successfully!&quot;
</pre>
</div>


</div>
</div>

<div id="issue-18">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_compat.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_compat.py</a><br>
    <b>Line number: </b>79<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
78	            self.detach()
79	        except Exception:
80	            pass
81	
</pre>
</div>


</div>
</div>

<div id="issue-19">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_compat.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_compat.py</a><br>
    <b>Line number: </b>172<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
171	            return False
172	        except Exception:
173	            pass
174	        return default
</pre>
</div>


</div>
</div>

<div id="issue-20">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Standard pseudo-random generators are not suitable for security/cryptographic purposes.<br>
    <b>Test ID:</b> B311<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/330.html" target="_blank">CWE-330</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_compat.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_compat.py</a><br>
    <b>Line number: </b>439<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b311-random" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b311-random</a><br>

<div class="code">
<pre>
438	            os.path.dirname(filename),
439	            f&quot;.__atomic-write{random.randrange(1 &lt;&lt; 32):08x}&quot;,
440	        )
</pre>
</div>


</div>
</div>

<div id="issue-21">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_compat.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_compat.py</a><br>
    <b>Line number: </b>559<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
558	            _ansi_stream_wrappers[stream] = rv
559	        except Exception:
560	            pass
561	
</pre>
</div>


</div>
</div>

<div id="issue-22">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_compat.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_compat.py</a><br>
    <b>Line number: </b>603<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
602	            cache[stream] = rv
603	        except Exception:
604	            pass
605	        return rv
</pre>
</div>


</div>
</div>

<div id="issue-23">
<div class="issue-block issue-sev-low">
    <b>start_process_with_a_shell: </b> Starting a process with a shell: Seems safe, but may be changed in the future, consider rewriting without shell<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>358<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
357	        return _tempfilepager(generator, &quot;more &lt;&quot;, color)
358	    if hasattr(os, &quot;system&quot;) and os.system(&quot;(less) 2&gt;/dev/null&quot;) == 0:
359	        return _pipepager(generator, &quot;less&quot;, color)
</pre>
</div>


</div>
</div>

<div id="issue-24">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>358<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
357	        return _tempfilepager(generator, &quot;more &lt;&quot;, color)
358	    if hasattr(os, &quot;system&quot;) and os.system(&quot;(less) 2&gt;/dev/null&quot;) == 0:
359	        return _pipepager(generator, &quot;less&quot;, color)
</pre>
</div>


</div>
</div>

<div id="issue-25">
<div class="issue-block issue-sev-high">
    <b>start_process_with_a_shell: </b> Starting a process with a shell, possible injection detected, security issue.<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>366<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
365	    try:
366	        if hasattr(os, &quot;system&quot;) and os.system(f&#x27;more &quot;{filename}&quot;&#x27;) == 0:
367	            return _pipepager(generator, &quot;more&quot;, color)
</pre>
</div>


</div>
</div>

<div id="issue-26">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>377<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
376	    &quot;&quot;&quot;
377	    import subprocess
378	
</pre>
</div>


</div>
</div>

<div id="issue-27">
<div class="issue-block issue-sev-high">
    <b>subprocess_popen_with_shell_equals_true: </b> subprocess call with shell=True identified, security issue.<br>
    <b>Test ID:</b> B602<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>392<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b602_subprocess_popen_with_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b602_subprocess_popen_with_shell_equals_true.html</a><br>

<div class="code">
<pre>
391	
392	    c = subprocess.Popen(cmd, shell=True, stdin=subprocess.PIPE, env=env)
393	    stdin = t.cast(t.BinaryIO, c.stdin)
</pre>
</div>


</div>
</div>

<div id="issue-28">
<div class="issue-block issue-sev-high">
    <b>start_process_with_a_shell: </b> Starting a process with a shell, possible injection detected, security issue.<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>438<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
437	    try:
438	        os.system(f&#x27;{cmd} &quot;{filename}&quot;&#x27;)
439	    finally:
</pre>
</div>


</div>
</div>

<div id="issue-29">
<div class="issue-block issue-sev-high">
    <b>start_process_with_a_shell: </b> Starting a process with a shell, possible injection detected, security issue.<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>476<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
475	        for editor in &quot;sensible-editor&quot;, &quot;vim&quot;, &quot;nano&quot;:
476	            if os.system(f&quot;which {editor} &gt;/dev/null 2&gt;&amp;1&quot;) == 0:
477	                return editor
</pre>
</div>


</div>
</div>

<div id="issue-30">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>481<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
480	    def edit_file(self, filename: str) -&gt; None:
481	        import subprocess
482	
</pre>
</div>


</div>
</div>

<div id="issue-31">
<div class="issue-block issue-sev-high">
    <b>subprocess_popen_with_shell_equals_true: </b> subprocess call with shell=True identified, security issue.<br>
    <b>Test ID:</b> B602<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>491<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b602_subprocess_popen_with_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b602_subprocess_popen_with_shell_equals_true.html</a><br>

<div class="code">
<pre>
490	        try:
491	            c = subprocess.Popen(f&#x27;{editor} &quot;{filename}&quot;&#x27;, env=environ, shell=True)
492	            exit_code = c.wait()
</pre>
</div>


</div>
</div>

<div id="issue-32">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>551<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
550	def open_url(url: str, wait: bool = False, locate: bool = False) -&gt; int:
551	    import subprocess
552	
</pre>
</div>


</div>
</div>

<div id="issue-33">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>570<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
569	        try:
570	            return subprocess.Popen(args, stderr=null).wait()
571	        finally:
</pre>
</div>


</div>
</div>

<div id="issue-34">
<div class="issue-block issue-sev-high">
    <b>start_process_with_a_shell: </b> Starting a process with a shell, possible injection detected, security issue.<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>581<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
580	            args = f&#x27;start {wait_str} &quot;&quot; &quot;{url}&quot;&#x27;
581	        return os.system(args)
582	    elif CYGWIN:
</pre>
</div>


</div>
</div>

<div id="issue-35">
<div class="issue-block issue-sev-high">
    <b>start_process_with_a_shell: </b> Starting a process with a shell, possible injection detected, security issue.<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>590<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
589	            args = f&#x27;cygstart {wait_str} &quot;{url}&quot;&#x27;
590	        return os.system(args)
591	
</pre>
</div>


</div>
</div>

<div id="issue-36">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>597<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
596	            url = _unquote_file(url)
597	        c = subprocess.Popen([&quot;xdg-open&quot;, url])
598	        if wait:
</pre>
</div>


</div>
</div>

<div id="issue-37">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>597<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
596	            url = _unquote_file(url)
597	        c = subprocess.Popen([&quot;xdg-open&quot;, url])
598	        if wait:
</pre>
</div>


</div>
</div>

<div id="issue-38">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_unicodefun.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_unicodefun.py</a><br>
    <b>Line number: </b>28<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
27	    if os.name == &quot;posix&quot;:
28	        import subprocess
29	
</pre>
</div>


</div>
</div>

<div id="issue-39">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_unicodefun.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_unicodefun.py</a><br>
    <b>Line number: </b>31<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
30	        try:
31	            rv = subprocess.Popen(
32	                [&quot;locale&quot;, &quot;-a&quot;],
33	                stdout=subprocess.PIPE,
34	                stderr=subprocess.PIPE,
35	                encoding=&quot;ascii&quot;,
36	                errors=&quot;replace&quot;,
37	            ).communicate()[0]
38	        except OSError:
</pre>
</div>


</div>
</div>

<div id="issue-40">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_unicodefun.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_unicodefun.py</a><br>
    <b>Line number: </b>31<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
30	        try:
31	            rv = subprocess.Popen(
32	                [&quot;locale&quot;, &quot;-a&quot;],
33	                stdout=subprocess.PIPE,
34	                stderr=subprocess.PIPE,
35	                encoding=&quot;ascii&quot;,
36	                errors=&quot;replace&quot;,
37	            ).communicate()[0]
38	        except OSError:
</pre>
</div>


</div>
</div>

<div id="issue-41">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_winconsole.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_winconsole.py</a><br>
    <b>Line number: </b>30<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
29	
30	assert sys.platform == &quot;win32&quot;
31	import msvcrt  # noqa: E402
</pre>
</div>


</div>
</div>

<div id="issue-42">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_winconsole.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/_winconsole.py</a><br>
    <b>Line number: </b>195<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
194	            self.flush()
195	        except Exception:
196	            pass
197	        return self.buffer.write(x)
</pre>
</div>


</div>
</div>

<div id="issue-43">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/core.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/core.py</a><br>
    <b>Line number: </b>1663<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
1662	                cmd_name, cmd, args = self.resolve_command(ctx, args)
1663	                assert cmd is not None
1664	                ctx.invoked_subcommand = cmd_name
</pre>
</div>


</div>
</div>

<div id="issue-44">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/core.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/core.py</a><br>
    <b>Line number: </b>1685<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
1684	                cmd_name, cmd, args = self.resolve_command(ctx, args)
1685	                assert cmd is not None
1686	                sub_ctx = cmd.make_context(
</pre>
</div>


</div>
</div>

<div id="issue-45">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/core.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/core.py</a><br>
    <b>Line number: </b>2802<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
2801	        &quot;&quot;&quot;
2802	        assert self.prompt is not None
2803	
</pre>
</div>


</div>
</div>

<div id="issue-46">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/decorators.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/decorators.py</a><br>
    <b>Line number: </b>343<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
342	        frame = inspect.currentframe()
343	        assert frame is not None
344	        assert frame.f_back is not None
</pre>
</div>


</div>
</div>

<div id="issue-47">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/decorators.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/decorators.py</a><br>
    <b>Line number: </b>344<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
343	        assert frame is not None
344	        assert frame.f_back is not None
345	        f_globals = frame.f_back.f_globals if frame is not None else None
</pre>
</div>


</div>
</div>

<div id="issue-48">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/parser.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/parser.py</a><br>
    <b>Line number: </b>225<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
224	        if self.nargs &gt; 1:
225	            assert value is not None
226	            holes = sum(1 for x in value if x is None)
</pre>
</div>


</div>
</div>

<div id="issue-49">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/shell_completion.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/shell_completion.py</a><br>
    <b>Line number: </b>303<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
302	    def _check_version(self) -&gt; None:
303	        import subprocess
304	
</pre>
</div>


</div>
</div>

<div id="issue-50">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/shell_completion.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/shell_completion.py</a><br>
    <b>Line number: </b>305<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
304	
305	        output = subprocess.run([&quot;bash&quot;, &quot;--version&quot;], stdout=subprocess.PIPE)
306	        match = re.search(r&quot;version (\d)\.(\d)\.\d&quot;, output.stdout.decode())
</pre>
</div>


</div>
</div>

<div id="issue-51">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/shell_completion.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/shell_completion.py</a><br>
    <b>Line number: </b>305<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
304	
305	        output = subprocess.run([&quot;bash&quot;, &quot;--version&quot;], stdout=subprocess.PIPE)
306	        match = re.search(r&quot;version (\d)\.(\d)\.\d&quot;, output.stdout.decode())
</pre>
</div>


</div>
</div>

<div id="issue-52">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/shell_completion.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/shell_completion.py</a><br>
    <b>Line number: </b>436<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
435	
436	    assert param.name is not None
437	    value = ctx.params[param.name]
</pre>
</div>


</div>
</div>

<div id="issue-53">
<div class="issue-block issue-sev-low">
    <b>start_process_with_a_shell: </b> Starting a process with a shell: Seems safe, but may be changed in the future, consider rewriting without shell<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/termui.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/termui.py</a><br>
    <b>Line number: </b>467<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
466	    if WIN:
467	        os.system(&quot;cls&quot;)
468	    else:
</pre>
</div>


</div>
</div>

<div id="issue-54">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/termui.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/termui.py</a><br>
    <b>Line number: </b>467<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
466	    if WIN:
467	        os.system(&quot;cls&quot;)
468	    else:
</pre>
</div>


</div>
</div>

<div id="issue-55">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/testing.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/testing.py</a><br>
    <b>Line number: </b>326<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
325	                        del os.environ[key]
326	                    except Exception:
327	                        pass
328	                else:
</pre>
</div>


</div>
</div>

<div id="issue-56">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/testing.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/testing.py</a><br>
    <b>Line number: </b>336<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
335	                        del os.environ[key]
336	                    except Exception:
337	                        pass
338	                else:
</pre>
</div>


</div>
</div>

<div id="issue-57">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/utils.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/click/utils.py</a><br>
    <b>Line number: </b>36<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
35	            return func(*args, **kwargs)
36	        except Exception:
37	            pass
38	
</pre>
</div>


</div>
</div>

<div id="issue-58">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_string: </b> Possible hardcoded password: ' '<br>
    <b>Test ID:</b> B105<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/parser/_parser.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/parser/_parser.py</a><br>
    <b>Line number: </b>122<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b105_hardcoded_password_string.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b105_hardcoded_password_string.html</a><br>

<div class="code">
<pre>
121	                elif self.isspace(nextchar):
122	                    token = &#x27; &#x27;
123	                    break  # emit token
</pre>
</div>


</div>
</div>

<div id="issue-59">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/parser/_parser.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/parser/_parser.py</a><br>
    <b>Line number: </b>367<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
366	        # Function contract is that the year is always positive
367	        assert year &gt;= 0
368	
</pre>
</div>


</div>
</div>

<div id="issue-60">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/parser/_parser.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/parser/_parser.py</a><br>
    <b>Line number: </b>465<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
464	            key = [x for x in [&#x27;y&#x27;, &#x27;m&#x27;, &#x27;d&#x27;] if x not in strids]
465	            assert len(missing) == len(key) == 1
466	            key = key[0]
</pre>
</div>


</div>
</div>

<div id="issue-61">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/parser/_parser.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/parser/_parser.py</a><br>
    <b>Line number: </b>470<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
469	
470	        assert len(self) == len(strids)  # otherwise this should not be called
471	        out = {key: self[strids[key]] for key in strids}
</pre>
</div>


</div>
</div>

<div id="issue-62">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/parser/_parser.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/parser/_parser.py</a><br>
    <b>Line number: </b>1457<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
1456	
1457	                assert l[i] == &#x27;,&#x27;
1458	
</pre>
</div>


</div>
</div>

<div id="issue-63">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/parser/_parser.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/parser/_parser.py</a><br>
    <b>Line number: </b>1523<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
1522	                        i += 1
1523	                        assert l[i] in (&#x27;-&#x27;, &#x27;.&#x27;)
1524	                        used_idxs.append(i)
</pre>
</div>


</div>
</div>

<div id="issue-64">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/parser/_parser.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/parser/_parser.py</a><br>
    <b>Line number: </b>1531<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
1530	                        i += 1
1531	                        assert l[i] in (&#x27;-&#x27;, &#x27;.&#x27;)
1532	                        used_idxs.append(i)
</pre>
</div>


</div>
</div>

<div id="issue-65">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/parser/_parser.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/parser/_parser.py</a><br>
    <b>Line number: </b>1568<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
1567	
1568	                    assert i == len_l or l[i] == &#x27;,&#x27;
1569	
</pre>
</div>


</div>
</div>

<div id="issue-66">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/parser/_parser.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/parser/_parser.py</a><br>
    <b>Line number: </b>1572<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
1571	
1572	                assert i &gt;= len_l
1573	
</pre>
</div>


</div>
</div>

<div id="issue-67">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/relativedelta.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/relativedelta.py</a><br>
    <b>Line number: </b>369<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
368	        if self.months:
369	            assert 1 &lt;= abs(self.months) &lt;= 12
370	            month += self.months
</pre>
</div>


</div>
</div>

<div id="issue-68">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/tz/tz.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/tz/tz.py</a><br>
    <b>Line number: </b>1748<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
1747	            return tz.is_ambiguous(dt)
1748	        except Exception:
1749	            pass
1750	
</pre>
</div>


</div>
</div>

<div id="issue-69">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/zoneinfo/rebuild.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/zoneinfo/rebuild.py</a><br>
    <b>Line number: </b>6<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
5	import json
6	from subprocess import check_call, check_output
7	from tarfile import TarFile
</pre>
</div>


</div>
</div>

<div id="issue-70">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/zoneinfo/rebuild.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/zoneinfo/rebuild.py</a><br>
    <b>Line number: </b>52<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
51	    try:
52	        help_text = check_output([&quot;zic&quot;, &quot;--help&quot;])
53	    except OSError as e:
</pre>
</div>


</div>
</div>

<div id="issue-71">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/zoneinfo/rebuild.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/zoneinfo/rebuild.py</a><br>
    <b>Line number: </b>52<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
51	    try:
52	        help_text = check_output([&quot;zic&quot;, &quot;--help&quot;])
53	    except OSError as e:
</pre>
</div>


</div>
</div>

<div id="issue-72">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/zoneinfo/rebuild.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/dateutil/zoneinfo/rebuild.py</a><br>
    <b>Line number: </b>62<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
61	
62	    check_call([&quot;zic&quot;] + bloat_args + [&quot;-d&quot;, zonedir] + filepaths)
63	
</pre>
</div>


</div>
</div>

<div id="issue-73">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/main.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/main.py</a><br>
    <b>Line number: </b>26<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
25	        statement_returns_valid_policy = False
26	        statement = f&quot;select policy_name from policies where policy_name=&#x27;{policy}&#x27; and public=&#x27;True&#x27;&quot;
27	        for row in db.query(statement):
</pre>
</div>


</div>
</div>

<div id="issue-74">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/pytz/reference.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/pytz/reference.py</a><br>
    <b>Line number: </b>124<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
123	            return ZERO
124	        assert dt.tzinfo is self
125	
</pre>
</div>


</div>
</div>

<div id="issue-75">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/pytz/tzfile.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/pytz/tzfile.py</a><br>
    <b>Line number: </b>31<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
30	    # Make sure it is a tzfile(5) file
31	    assert magic == _byte_string(&#x27;TZif&#x27;), &#x27;Got magic %s&#x27; % repr(magic)
32	
</pre>
</div>


</div>
</div>

<div id="issue-76">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/pytz/tzfile.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/pytz/tzfile.py</a><br>
    <b>Line number: </b>40<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
39	    # make sure we unpacked the right number of values
40	    assert len(data) == 2 * timecnt + 3 * typecnt + 1
41	    transitions = [memorized_datetime(trans)
</pre>
</div>


</div>
</div>

<div id="issue-77">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/pytz/tzinfo.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/pytz/tzinfo.py</a><br>
    <b>Line number: </b>392<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
391	                local_dt.replace(tzinfo=None) - local_dt.tzinfo._utcoffset)
392	            assert utc_time not in dates
393	            dates[utc_time] = local_dt
</pre>
</div>


</div>
</div>

<div id="issue-78">
<div class="issue-block issue-sev-medium">
    <b>exec_used: </b> Use of exec detected.<br>
    <b>Test ID:</b> B102<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/six.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/six.py</a><br>
    <b>Line number: </b>735<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b102_exec_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b102_exec_used.html</a><br>

<div class="code">
<pre>
734	            _locs_ = _globs_
735	        exec(&quot;&quot;&quot;exec _code_ in _globs_, _locs_&quot;&quot;&quot;)
736	
</pre>
</div>


</div>
</div>

<div id="issue-79">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/cli.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/cli.py</a><br>
    <b>Line number: </b>1306<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1305	            if not db[view_name].exists():
1306	                db.create_view(view_name, &quot;select * from [{}]&quot;.format(csv_table))
1307	
</pre>
</div>


</div>
</div>

<div id="issue-80">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/cli.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/cli.py</a><br>
    <b>Line number: </b>1495<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1494	        path=path,
1495	        sql=&quot;select {} from [{}]&quot;.format(columns, dbtable),
1496	        nl=nl,
</pre>
</div>


</div>
</div>

<div id="issue-81">
<div class="issue-block issue-sev-high">
    <b>hashlib: </b> Use of weak MD5 hash for security. Consider usedforsecurity=False<br>
    <b>Test ID:</b> B324<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/327.html" target="_blank">CWE-327</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/cli.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/cli.py</a><br>
    <b>Line number: </b>1900<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html</a><br>

<div class="code">
<pre>
1899	                        &quot;sha256&quot;: lambda p: hashlib.sha256(stdin_data).hexdigest(),
1900	                        &quot;md5&quot;: lambda p: hashlib.md5(stdin_data).hexdigest(),
1901	                        &quot;size&quot;: lambda p: len(stdin_data),
</pre>
</div>


</div>
</div>

<div id="issue-82">
<div class="issue-block issue-sev-medium">
    <b>exec_used: </b> Use of exec detected.<br>
    <b>Test ID:</b> B102<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/cli.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/cli.py</a><br>
    <b>Line number: </b>2126<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b102_exec_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b102_exec_used.html</a><br>

<div class="code">
<pre>
2125	        globals[import_] = __import__(import_)
2126	    exec(code_o, globals, locals)
2127	    fn = locals[&quot;fn&quot;]
</pre>
</div>


</div>
</div>

<div id="issue-83">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/cli.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/cli.py</a><br>
    <b>Line number: </b>2131<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2130	        db.conn.create_function(&quot;preview_transform&quot;, 1, lambda v: fn(v) if v else v)
2131	        sql = &quot;&quot;&quot;
2132	            select
2133	                [{column}] as value,
2134	                preview_transform([{column}]) as preview
2135	            from [{table}]{where} limit 10
2136	        &quot;&quot;&quot;.format(
2137	            column=columns[0],
</pre>
</div>


</div>
</div>

<div id="issue-84">
<div class="issue-block issue-sev-high">
    <b>hashlib: </b> Use of weak MD5 hash for security. Consider usedforsecurity=False<br>
    <b>Test ID:</b> B324<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/327.html" target="_blank">CWE-327</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/cli.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/cli.py</a><br>
    <b>Line number: </b>2192<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html</a><br>

<div class="code">
<pre>
2191	    &quot;sha256&quot;: lambda p: hashlib.sha256(p.resolve().read_bytes()).hexdigest(),
2192	    &quot;md5&quot;: lambda p: hashlib.md5(p.resolve().read_bytes()).hexdigest(),
2193	    &quot;mode&quot;: lambda p: p.stat().st_mode,
</pre>
</div>


</div>
</div>

<div id="issue-85">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>296<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
295	    ):
296	        assert (filename_or_conn is not None and not memory) or (
297	            filename_or_conn is None and memory
298	        ), &quot;Either specify a filename_or_conn or pass memory=True&quot;
299	        if memory or filename_or_conn == &quot;:memory:&quot;:
</pre>
</div>


</div>
</div>

<div id="issue-86">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>306<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
305	        else:
306	            assert not recreate, &quot;recreate cannot be used with connections, only paths&quot;
307	            self.conn = filename_or_conn
</pre>
</div>


</div>
</div>

<div id="issue-87">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>471<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
470	            where.append(&quot;sql like &#x27;%USING FTS5%&#x27;&quot;)
471	        sql = &quot;select name from sqlite_master where {}&quot;.format(&quot; AND &quot;.join(where))
472	        return [r[0] for r in self.execute(sql).fetchall()]
</pre>
</div>


</div>
</div>

<div id="issue-88">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>559<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
558	        &quot;&quot;&quot;
559	        sql = &quot;select [table], count from {}&quot;.format(self._counts_table_name)
560	        if tables:
</pre>
</div>


</div>
</div>

<div id="issue-89">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>602<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
601	            return fks
602	        assert all(
603	            isinstance(fk, (tuple, list)) for fk in foreign_keys
604	        ), &quot;foreign_keys= should be a list of tuples&quot;
605	        fks = []
</pre>
</div>


</div>
</div>

<div id="issue-90">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>607<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
606	        for tuple_or_list in foreign_keys:
607	            assert len(tuple_or_list) in (
608	                2,
609	                3,
610	            ), &quot;foreign_keys= should be a list of tuple pairs or triples&quot;
611	            if len(tuple_or_list) == 3:
</pre>
</div>


</div>
</div>

<div id="issue-91">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>649<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
648	            if isinstance(extract_column, tuple):
649	                assert False
650	            # Ensure other table exists
</pre>
</div>


</div>
</div>

<div id="issue-92">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>660<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
659	        defaults = defaults or {}
660	        assert all(
661	            n in columns for n in not_null
662	        ), &quot;not_null set {} includes items not in columns {}&quot;.format(
663	            repr(not_null), repr(set(columns.keys()))
664	        )
665	        assert all(
</pre>
</div>


</div>
</div>

<div id="issue-93">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>665<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
664	        )
665	        assert all(
666	            n in columns for n in defaults
667	        ), &quot;defaults set {} includes items not in columns {}&quot;.format(
668	            repr(set(defaults)), repr(set(columns.keys()))
669	        )
670	        validate_column_names(columns.keys())
</pre>
</div>


</div>
</div>

<div id="issue-94">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>788<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
787	        &quot;&quot;&quot;
788	        assert not (
789	            ignore and replace
790	        ), &quot;Use one or the other of ignore/replace, not both&quot;
791	        create_sql = &quot;CREATE VIEW {name} AS {sql}&quot;.format(name=name, sql=sql)
</pre>
</div>


</div>
</div>

<div id="issue-95">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>828<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
827	        # foreign_keys is a list of explicit 4-tuples
828	        assert all(
829	            len(fk) == 4 and isinstance(fk, (list, tuple)) for fk in foreign_keys
830	        ), &quot;foreign_keys must be a list of 4-tuples, (table, column, other_table, other_column)&quot;
831	
</pre>
</div>


</div>
</div>

<div id="issue-96">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>924<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
923	        &quot;Executes ``SELECT count(*) FROM table WHERE ...`` and returns a count.&quot;
924	        sql = &quot;select count(*) from [{}]&quot;.format(self.name)
925	        if where is not None:
</pre>
</div>


</div>
</div>

<div id="issue-97">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>966<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
965	            return
966	        sql = &quot;select {} from [{}]&quot;.format(select, self.name)
967	        if where is not None:
</pre>
</div>


</div>
</div>

<div id="issue-98">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>1268<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
1267	        &quot;&quot;&quot;
1268	        assert self.exists(), &quot;Cannot transform a table that doesn&#x27;t exist yet&quot;
1269	        sqls = self.transform_sql(
</pre>
</div>


</div>
</div>

<div id="issue-99">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>1359<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
1358	        else:
1359	            assert False, &quot;not_null must be a dict or a set or None&quot;
1360	        # defaults=
</pre>
</div>


</div>
</div>

<div id="issue-100">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>1400<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1399	            new_cols.append(to_)
1400	        copy_sql = &quot;INSERT INTO [{new_table}] ({new_cols})\n   SELECT {old_cols} FROM [{old_table}];&quot;.format(
1401	            new_table=new_table_name,
</pre>
</div>


</div>
</div>

<div id="issue-101">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>1469<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1468	        self.db.execute(
1469	            &quot;INSERT OR IGNORE INTO [{lookup_table}] ({lookup_columns}) SELECT DISTINCT {table_cols} FROM [{table}]&quot;.format(
1470	                lookup_table=table,
</pre>
</div>


</div>
</div>

<div id="issue-102">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>1482<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1481	        self.db.execute(
1482	            &quot;UPDATE [{table}] SET [{magic_lookup_column}] = (SELECT id FROM [{lookup_table}] WHERE {where})&quot;.format(
1483	                table=self.name,
</pre>
</div>


</div>
</div>

<div id="issue-103">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>1961<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
1960	        fts_table = self.detect_fts()
1961	        assert fts_table, &quot;Full-text search is not configured for table &#x27;{}&#x27;&quot;.format(
1962	            self.name
1963	        )
1964	        virtual_table_using = self.db[fts_table].virtual_table_using
</pre>
</div>


</div>
</div>

<div id="issue-104">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2051<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2050	        wheres = [&quot;[{}] = ?&quot;.format(pk_name) for pk_name in self.pks]
2051	        sql = &quot;delete from [{table}] where {wheres}&quot;.format(
2052	            table=self.name, wheres=&quot; and &quot;.join(wheres)
</pre>
</div>


</div>
</div>

<div id="issue-105">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2064<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2063	            return self
2064	        sql = &quot;delete from [{}]&quot;.format(self.name)
2065	        if where is not None:
</pre>
</div>


</div>
</div>

<div id="issue-106">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2107<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2106	        args.extend(pk_values)
2107	        sql = &quot;update [{table}] set {sets} where {wheres}&quot;.format(
2108	            table=self.name, sets=&quot;, &quot;.join(sets), wheres=&quot; and &quot;.join(wheres)
</pre>
</div>


</div>
</div>

<div id="issue-107">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2122<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
2121	            # TODO: Test this works (rolls back) - use better exception:
2122	            assert rowcount == 1
2123	        self.last_pk = pk_values[0] if len(pks) == 1 else pk_values
</pre>
</div>


</div>
</div>

<div id="issue-108">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2170<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
2169	        if output is not None:
2170	            assert len(columns) == 1, &quot;output= can only be used with a single column&quot;
2171	            if output not in self.columns_dict:
</pre>
</div>


</div>
</div>

<div id="issue-109">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2184<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2183	            self.db.register_function(convert_value)
2184	            sql = &quot;update [{table}] set {sets}{where};&quot;.format(
2185	                table=self.name,
</pre>
</div>


</div>
</div>

<div id="issue-110">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2300<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2299	                if set_cols:
2300	                    sql2 = &quot;UPDATE [{table}] SET {pairs} WHERE {wheres}&quot;.format(
2301	                        table=self.name,
</pre>
</div>


</div>
</div>

<div id="issue-111">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2536<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
2535	            raise PrimaryKeyRequired(&quot;upsert() requires a pk&quot;)
2536	        assert not (hash_id and pk), &quot;Use either pk= or hash_id=&quot;
2537	        if hash_id:
</pre>
</div>


</div>
</div>

<div id="issue-112">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2540<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
2539	
2540	        assert not (
2541	            ignore and replace
2542	        ), &quot;Use either ignore=True or replace=True, not both&quot;
2543	        all_columns = []
</pre>
</div>


</div>
</div>

<div id="issue-113">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2555<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
2554	        num_columns = len(first_record.keys())
2555	        assert (
2556	            num_columns &lt;= SQLITE_MAX_VARS
2557	        ), &quot;Rows can have a maximum of {} columns&quot;.format(SQLITE_MAX_VARS)
2558	        batch_size = max(1, min(batch_size, SQLITE_MAX_VARS // num_columns))
</pre>
</div>


</div>
</div>

<div id="issue-114">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2562<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2561	        if truncate and self.exists():
2562	            self.db.execute(&quot;DELETE FROM [{}];&quot;.format(self.name))
2563	        for chunk in chunks(itertools.chain([first_record], records), batch_size):
</pre>
</div>


</div>
</div>

<div id="issue-115">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2703<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
2702	        # lookups is a dictionary - all columns will be used for a unique index
2703	        assert isinstance(column_values, dict)
2704	        if self.exists():
</pre>
</div>


</div>
</div>

<div id="issue-116">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2761<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
2760	        if lookup is not None:
2761	            assert record_or_iterable is None, &quot;Provide lookup= or record, not both&quot;
2762	        else:
</pre>
</div>


</div>
</div>

<div id="issue-117">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2763<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
2762	        else:
2763	            assert record_or_iterable is not None, &quot;Provide lookup= or record, not both&quot;
2764	        tables = list(sorted([self.name, other_table.name]))
</pre>
</div>


</div>
</div>

<div id="issue-118">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2834<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2833	        num_null = db.execute(
2834	            &quot;select count(*) from [{}] where [{}] is null&quot;.format(table, column)
2835	        ).fetchone()[0]
</pre>
</div>


</div>
</div>

<div id="issue-119">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2837<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2836	        num_blank = db.execute(
2837	            &quot;select count(*) from [{}] where [{}] = &#x27;&#x27;&quot;.format(table, column)
2838	        ).fetchone()[0]
</pre>
</div>


</div>
</div>

<div id="issue-120">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2840<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2839	        num_distinct = db.execute(
2840	            &quot;select count(distinct [{}]) from [{}]&quot;.format(column, table)
2841	        ).fetchone()[0]
</pre>
</div>


</div>
</div>

<div id="issue-121">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2846<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2845	            value = db.execute(
2846	                &quot;select [{}] from [{}] limit 1&quot;.format(column, table)
2847	            ).fetchone()[0]
</pre>
</div>


</div>
</div>

<div id="issue-122">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2853<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2852	                for r in db.execute(
2853	                    &quot;select [{}], count(*) from [{}] group by [{}] order by count(*) desc, [{}] limit {}&quot;.format(
2854	                        column, table, column, column, common_limit
</pre>
</div>


</div>
</div>

<div id="issue-123">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2866<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2865	                    for r in db.execute(
2866	                        &quot;select [{}], count(*) from [{}] group by [{}] order by count(*), [{}] desc limit {}&quot;.format(
2867	                            column, table, column, column, common_limit
</pre>
</div>


</div>
</div>

<div id="issue-124">
<div class="issue-block issue-sev-high">
    <b>hashlib: </b> Use of weak SHA1 hash for security. Consider usedforsecurity=False<br>
    <b>Test ID:</b> B324<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/327.html" target="_blank">CWE-327</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2926<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html</a><br>

<div class="code">
<pre>
2925	def _hash(record):
2926	    return hashlib.sha1(
2927	        json.dumps(record, separators=(&quot;,&quot;, &quot;:&quot;), sort_keys=True, default=repr).encode(
2928	            &quot;utf8&quot;
2929	        )
2930	    ).hexdigest()
2931	
</pre>
</div>


</div>
</div>

<div id="issue-125">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2946<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
2945	    for column in columns:
2946	        assert (
2947	            &quot;[&quot; not in column and &quot;]&quot; not in column
2948	        ), &quot;&#x27;[&#x27; and &#x27;]&#x27; cannot be used in column names&quot;
</pre>
</div>


</div>
</div>

<div id="issue-126">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/utils.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/sqlite_utils/utils.py</a><br>
    <b>Line number: </b>67<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
66	    # https://www.sqlite.org/datatype3.html#determination_of_column_affinity
67	    assert isinstance(column_type, str)
68	    column_type = column_type.upper().strip()
</pre>
</div>


</div>
</div>

<div id="issue-127">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/tabulate.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda1_src/tabulate.py</a><br>
    <b>Line number: </b>1599<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
1598	    if colalign is not None:
1599	        assert isinstance(colalign, Iterable)
1600	        for idx, align in enumerate(colalign):
</pre>
</div>


</div>
</div>

<div id="issue-128">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_compat.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_compat.py</a><br>
    <b>Line number: </b>79<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
78	            self.detach()
79	        except Exception:
80	            pass
81	
</pre>
</div>


</div>
</div>

<div id="issue-129">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_compat.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_compat.py</a><br>
    <b>Line number: </b>172<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
171	            return False
172	        except Exception:
173	            pass
174	        return default
</pre>
</div>


</div>
</div>

<div id="issue-130">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Standard pseudo-random generators are not suitable for security/cryptographic purposes.<br>
    <b>Test ID:</b> B311<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/330.html" target="_blank">CWE-330</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_compat.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_compat.py</a><br>
    <b>Line number: </b>439<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b311-random" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b311-random</a><br>

<div class="code">
<pre>
438	            os.path.dirname(filename),
439	            f&quot;.__atomic-write{random.randrange(1 &lt;&lt; 32):08x}&quot;,
440	        )
</pre>
</div>


</div>
</div>

<div id="issue-131">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_compat.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_compat.py</a><br>
    <b>Line number: </b>559<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
558	            _ansi_stream_wrappers[stream] = rv
559	        except Exception:
560	            pass
561	
</pre>
</div>


</div>
</div>

<div id="issue-132">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_compat.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_compat.py</a><br>
    <b>Line number: </b>603<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
602	            cache[stream] = rv
603	        except Exception:
604	            pass
605	        return rv
</pre>
</div>


</div>
</div>

<div id="issue-133">
<div class="issue-block issue-sev-low">
    <b>start_process_with_a_shell: </b> Starting a process with a shell: Seems safe, but may be changed in the future, consider rewriting without shell<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>358<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
357	        return _tempfilepager(generator, &quot;more &lt;&quot;, color)
358	    if hasattr(os, &quot;system&quot;) and os.system(&quot;(less) 2&gt;/dev/null&quot;) == 0:
359	        return _pipepager(generator, &quot;less&quot;, color)
</pre>
</div>


</div>
</div>

<div id="issue-134">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>358<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
357	        return _tempfilepager(generator, &quot;more &lt;&quot;, color)
358	    if hasattr(os, &quot;system&quot;) and os.system(&quot;(less) 2&gt;/dev/null&quot;) == 0:
359	        return _pipepager(generator, &quot;less&quot;, color)
</pre>
</div>


</div>
</div>

<div id="issue-135">
<div class="issue-block issue-sev-high">
    <b>start_process_with_a_shell: </b> Starting a process with a shell, possible injection detected, security issue.<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>366<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
365	    try:
366	        if hasattr(os, &quot;system&quot;) and os.system(f&#x27;more &quot;{filename}&quot;&#x27;) == 0:
367	            return _pipepager(generator, &quot;more&quot;, color)
</pre>
</div>


</div>
</div>

<div id="issue-136">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>377<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
376	    &quot;&quot;&quot;
377	    import subprocess
378	
</pre>
</div>


</div>
</div>

<div id="issue-137">
<div class="issue-block issue-sev-high">
    <b>subprocess_popen_with_shell_equals_true: </b> subprocess call with shell=True identified, security issue.<br>
    <b>Test ID:</b> B602<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>392<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b602_subprocess_popen_with_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b602_subprocess_popen_with_shell_equals_true.html</a><br>

<div class="code">
<pre>
391	
392	    c = subprocess.Popen(cmd, shell=True, stdin=subprocess.PIPE, env=env)
393	    stdin = t.cast(t.BinaryIO, c.stdin)
</pre>
</div>


</div>
</div>

<div id="issue-138">
<div class="issue-block issue-sev-high">
    <b>start_process_with_a_shell: </b> Starting a process with a shell, possible injection detected, security issue.<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>438<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
437	    try:
438	        os.system(f&#x27;{cmd} &quot;{filename}&quot;&#x27;)
439	    finally:
</pre>
</div>


</div>
</div>

<div id="issue-139">
<div class="issue-block issue-sev-high">
    <b>start_process_with_a_shell: </b> Starting a process with a shell, possible injection detected, security issue.<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>476<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
475	        for editor in &quot;sensible-editor&quot;, &quot;vim&quot;, &quot;nano&quot;:
476	            if os.system(f&quot;which {editor} &gt;/dev/null 2&gt;&amp;1&quot;) == 0:
477	                return editor
</pre>
</div>


</div>
</div>

<div id="issue-140">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>481<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
480	    def edit_file(self, filename: str) -&gt; None:
481	        import subprocess
482	
</pre>
</div>


</div>
</div>

<div id="issue-141">
<div class="issue-block issue-sev-high">
    <b>subprocess_popen_with_shell_equals_true: </b> subprocess call with shell=True identified, security issue.<br>
    <b>Test ID:</b> B602<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>491<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b602_subprocess_popen_with_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b602_subprocess_popen_with_shell_equals_true.html</a><br>

<div class="code">
<pre>
490	        try:
491	            c = subprocess.Popen(f&#x27;{editor} &quot;{filename}&quot;&#x27;, env=environ, shell=True)
492	            exit_code = c.wait()
</pre>
</div>


</div>
</div>

<div id="issue-142">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>551<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
550	def open_url(url: str, wait: bool = False, locate: bool = False) -&gt; int:
551	    import subprocess
552	
</pre>
</div>


</div>
</div>

<div id="issue-143">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>570<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
569	        try:
570	            return subprocess.Popen(args, stderr=null).wait()
571	        finally:
</pre>
</div>


</div>
</div>

<div id="issue-144">
<div class="issue-block issue-sev-high">
    <b>start_process_with_a_shell: </b> Starting a process with a shell, possible injection detected, security issue.<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>581<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
580	            args = f&#x27;start {wait_str} &quot;&quot; &quot;{url}&quot;&#x27;
581	        return os.system(args)
582	    elif CYGWIN:
</pre>
</div>


</div>
</div>

<div id="issue-145">
<div class="issue-block issue-sev-high">
    <b>start_process_with_a_shell: </b> Starting a process with a shell, possible injection detected, security issue.<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>590<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
589	            args = f&#x27;cygstart {wait_str} &quot;{url}&quot;&#x27;
590	        return os.system(args)
591	
</pre>
</div>


</div>
</div>

<div id="issue-146">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>597<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
596	            url = _unquote_file(url)
597	        c = subprocess.Popen([&quot;xdg-open&quot;, url])
598	        if wait:
</pre>
</div>


</div>
</div>

<div id="issue-147">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_termui_impl.py</a><br>
    <b>Line number: </b>597<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
596	            url = _unquote_file(url)
597	        c = subprocess.Popen([&quot;xdg-open&quot;, url])
598	        if wait:
</pre>
</div>


</div>
</div>

<div id="issue-148">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_unicodefun.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_unicodefun.py</a><br>
    <b>Line number: </b>28<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
27	    if os.name == &quot;posix&quot;:
28	        import subprocess
29	
</pre>
</div>


</div>
</div>

<div id="issue-149">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_unicodefun.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_unicodefun.py</a><br>
    <b>Line number: </b>31<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
30	        try:
31	            rv = subprocess.Popen(
32	                [&quot;locale&quot;, &quot;-a&quot;],
33	                stdout=subprocess.PIPE,
34	                stderr=subprocess.PIPE,
35	                encoding=&quot;ascii&quot;,
36	                errors=&quot;replace&quot;,
37	            ).communicate()[0]
38	        except OSError:
</pre>
</div>


</div>
</div>

<div id="issue-150">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_unicodefun.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_unicodefun.py</a><br>
    <b>Line number: </b>31<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
30	        try:
31	            rv = subprocess.Popen(
32	                [&quot;locale&quot;, &quot;-a&quot;],
33	                stdout=subprocess.PIPE,
34	                stderr=subprocess.PIPE,
35	                encoding=&quot;ascii&quot;,
36	                errors=&quot;replace&quot;,
37	            ).communicate()[0]
38	        except OSError:
</pre>
</div>


</div>
</div>

<div id="issue-151">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_winconsole.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_winconsole.py</a><br>
    <b>Line number: </b>30<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
29	
30	assert sys.platform == &quot;win32&quot;
31	import msvcrt  # noqa: E402
</pre>
</div>


</div>
</div>

<div id="issue-152">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_winconsole.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/_winconsole.py</a><br>
    <b>Line number: </b>195<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
194	            self.flush()
195	        except Exception:
196	            pass
197	        return self.buffer.write(x)
</pre>
</div>


</div>
</div>

<div id="issue-153">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/core.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/core.py</a><br>
    <b>Line number: </b>1663<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
1662	                cmd_name, cmd, args = self.resolve_command(ctx, args)
1663	                assert cmd is not None
1664	                ctx.invoked_subcommand = cmd_name
</pre>
</div>


</div>
</div>

<div id="issue-154">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/core.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/core.py</a><br>
    <b>Line number: </b>1685<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
1684	                cmd_name, cmd, args = self.resolve_command(ctx, args)
1685	                assert cmd is not None
1686	                sub_ctx = cmd.make_context(
</pre>
</div>


</div>
</div>

<div id="issue-155">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/core.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/core.py</a><br>
    <b>Line number: </b>2802<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
2801	        &quot;&quot;&quot;
2802	        assert self.prompt is not None
2803	
</pre>
</div>


</div>
</div>

<div id="issue-156">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/decorators.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/decorators.py</a><br>
    <b>Line number: </b>343<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
342	        frame = inspect.currentframe()
343	        assert frame is not None
344	        assert frame.f_back is not None
</pre>
</div>


</div>
</div>

<div id="issue-157">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/decorators.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/decorators.py</a><br>
    <b>Line number: </b>344<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
343	        assert frame is not None
344	        assert frame.f_back is not None
345	        f_globals = frame.f_back.f_globals if frame is not None else None
</pre>
</div>


</div>
</div>

<div id="issue-158">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/parser.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/parser.py</a><br>
    <b>Line number: </b>225<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
224	        if self.nargs &gt; 1:
225	            assert value is not None
226	            holes = sum(1 for x in value if x is None)
</pre>
</div>


</div>
</div>

<div id="issue-159">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/shell_completion.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/shell_completion.py</a><br>
    <b>Line number: </b>303<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
302	    def _check_version(self) -&gt; None:
303	        import subprocess
304	
</pre>
</div>


</div>
</div>

<div id="issue-160">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/shell_completion.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/shell_completion.py</a><br>
    <b>Line number: </b>305<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
304	
305	        output = subprocess.run([&quot;bash&quot;, &quot;--version&quot;], stdout=subprocess.PIPE)
306	        match = re.search(r&quot;version (\d)\.(\d)\.\d&quot;, output.stdout.decode())
</pre>
</div>


</div>
</div>

<div id="issue-161">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/shell_completion.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/shell_completion.py</a><br>
    <b>Line number: </b>305<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
304	
305	        output = subprocess.run([&quot;bash&quot;, &quot;--version&quot;], stdout=subprocess.PIPE)
306	        match = re.search(r&quot;version (\d)\.(\d)\.\d&quot;, output.stdout.decode())
</pre>
</div>


</div>
</div>

<div id="issue-162">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/shell_completion.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/shell_completion.py</a><br>
    <b>Line number: </b>436<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
435	
436	    assert param.name is not None
437	    value = ctx.params[param.name]
</pre>
</div>


</div>
</div>

<div id="issue-163">
<div class="issue-block issue-sev-low">
    <b>start_process_with_a_shell: </b> Starting a process with a shell: Seems safe, but may be changed in the future, consider rewriting without shell<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/termui.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/termui.py</a><br>
    <b>Line number: </b>467<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
466	    if WIN:
467	        os.system(&quot;cls&quot;)
468	    else:
</pre>
</div>


</div>
</div>

<div id="issue-164">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/termui.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/termui.py</a><br>
    <b>Line number: </b>467<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
466	    if WIN:
467	        os.system(&quot;cls&quot;)
468	    else:
</pre>
</div>


</div>
</div>

<div id="issue-165">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/testing.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/testing.py</a><br>
    <b>Line number: </b>326<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
325	                        del os.environ[key]
326	                    except Exception:
327	                        pass
328	                else:
</pre>
</div>


</div>
</div>

<div id="issue-166">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/testing.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/testing.py</a><br>
    <b>Line number: </b>336<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
335	                        del os.environ[key]
336	                    except Exception:
337	                        pass
338	                else:
</pre>
</div>


</div>
</div>

<div id="issue-167">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/utils.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/click/utils.py</a><br>
    <b>Line number: </b>36<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
35	            return func(*args, **kwargs)
36	        except Exception:
37	            pass
38	
</pre>
</div>


</div>
</div>

<div id="issue-168">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_string: </b> Possible hardcoded password: ' '<br>
    <b>Test ID:</b> B105<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/parser/_parser.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/parser/_parser.py</a><br>
    <b>Line number: </b>122<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b105_hardcoded_password_string.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b105_hardcoded_password_string.html</a><br>

<div class="code">
<pre>
121	                elif self.isspace(nextchar):
122	                    token = &#x27; &#x27;
123	                    break  # emit token
</pre>
</div>


</div>
</div>

<div id="issue-169">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/parser/_parser.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/parser/_parser.py</a><br>
    <b>Line number: </b>367<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
366	        # Function contract is that the year is always positive
367	        assert year &gt;= 0
368	
</pre>
</div>


</div>
</div>

<div id="issue-170">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/parser/_parser.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/parser/_parser.py</a><br>
    <b>Line number: </b>465<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
464	            key = [x for x in [&#x27;y&#x27;, &#x27;m&#x27;, &#x27;d&#x27;] if x not in strids]
465	            assert len(missing) == len(key) == 1
466	            key = key[0]
</pre>
</div>


</div>
</div>

<div id="issue-171">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/parser/_parser.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/parser/_parser.py</a><br>
    <b>Line number: </b>470<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
469	
470	        assert len(self) == len(strids)  # otherwise this should not be called
471	        out = {key: self[strids[key]] for key in strids}
</pre>
</div>


</div>
</div>

<div id="issue-172">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/parser/_parser.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/parser/_parser.py</a><br>
    <b>Line number: </b>1457<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
1456	
1457	                assert l[i] == &#x27;,&#x27;
1458	
</pre>
</div>


</div>
</div>

<div id="issue-173">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/parser/_parser.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/parser/_parser.py</a><br>
    <b>Line number: </b>1523<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
1522	                        i += 1
1523	                        assert l[i] in (&#x27;-&#x27;, &#x27;.&#x27;)
1524	                        used_idxs.append(i)
</pre>
</div>


</div>
</div>

<div id="issue-174">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/parser/_parser.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/parser/_parser.py</a><br>
    <b>Line number: </b>1531<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
1530	                        i += 1
1531	                        assert l[i] in (&#x27;-&#x27;, &#x27;.&#x27;)
1532	                        used_idxs.append(i)
</pre>
</div>


</div>
</div>

<div id="issue-175">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/parser/_parser.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/parser/_parser.py</a><br>
    <b>Line number: </b>1568<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
1567	
1568	                    assert i == len_l or l[i] == &#x27;,&#x27;
1569	
</pre>
</div>


</div>
</div>

<div id="issue-176">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/parser/_parser.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/parser/_parser.py</a><br>
    <b>Line number: </b>1572<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
1571	
1572	                assert i &gt;= len_l
1573	
</pre>
</div>


</div>
</div>

<div id="issue-177">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/relativedelta.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/relativedelta.py</a><br>
    <b>Line number: </b>369<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
368	        if self.months:
369	            assert 1 &lt;= abs(self.months) &lt;= 12
370	            month += self.months
</pre>
</div>


</div>
</div>

<div id="issue-178">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/tz/tz.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/tz/tz.py</a><br>
    <b>Line number: </b>1748<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
1747	            return tz.is_ambiguous(dt)
1748	        except Exception:
1749	            pass
1750	
</pre>
</div>


</div>
</div>

<div id="issue-179">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/zoneinfo/rebuild.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/zoneinfo/rebuild.py</a><br>
    <b>Line number: </b>6<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
5	import json
6	from subprocess import check_call, check_output
7	from tarfile import TarFile
</pre>
</div>


</div>
</div>

<div id="issue-180">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/zoneinfo/rebuild.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/zoneinfo/rebuild.py</a><br>
    <b>Line number: </b>52<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
51	    try:
52	        help_text = check_output([&quot;zic&quot;, &quot;--help&quot;])
53	    except OSError as e:
</pre>
</div>


</div>
</div>

<div id="issue-181">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/zoneinfo/rebuild.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/zoneinfo/rebuild.py</a><br>
    <b>Line number: </b>52<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
51	    try:
52	        help_text = check_output([&quot;zic&quot;, &quot;--help&quot;])
53	    except OSError as e:
</pre>
</div>


</div>
</div>

<div id="issue-182">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/zoneinfo/rebuild.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/dateutil/zoneinfo/rebuild.py</a><br>
    <b>Line number: </b>62<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
61	
62	    check_call([&quot;zic&quot;] + bloat_args + [&quot;-d&quot;, zonedir] + filepaths)
63	
</pre>
</div>


</div>
</div>

<div id="issue-183">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/main.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/main.py</a><br>
    <b>Line number: </b>52<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
51	        # statement_returns_valid_policy = False
52	        statement = f&quot;select policy_document from policies where policy_name=&#x27;{policy}&#x27;&quot;
53	        for split_statement in statement.split(&quot;;&quot;):
</pre>
</div>


</div>
</div>

<div id="issue-184">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/pytz/reference.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/pytz/reference.py</a><br>
    <b>Line number: </b>124<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
123	            return ZERO
124	        assert dt.tzinfo is self
125	
</pre>
</div>


</div>
</div>

<div id="issue-185">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/pytz/tzfile.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/pytz/tzfile.py</a><br>
    <b>Line number: </b>31<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
30	    # Make sure it is a tzfile(5) file
31	    assert magic == _byte_string(&#x27;TZif&#x27;), &#x27;Got magic %s&#x27; % repr(magic)
32	
</pre>
</div>


</div>
</div>

<div id="issue-186">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/pytz/tzfile.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/pytz/tzfile.py</a><br>
    <b>Line number: </b>40<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
39	    # make sure we unpacked the right number of values
40	    assert len(data) == 2 * timecnt + 3 * typecnt + 1
41	    transitions = [memorized_datetime(trans)
</pre>
</div>


</div>
</div>

<div id="issue-187">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/pytz/tzinfo.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/pytz/tzinfo.py</a><br>
    <b>Line number: </b>392<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
391	                local_dt.replace(tzinfo=None) - local_dt.tzinfo._utcoffset)
392	            assert utc_time not in dates
393	            dates[utc_time] = local_dt
</pre>
</div>


</div>
</div>

<div id="issue-188">
<div class="issue-block issue-sev-medium">
    <b>exec_used: </b> Use of exec detected.<br>
    <b>Test ID:</b> B102<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/six.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/six.py</a><br>
    <b>Line number: </b>735<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b102_exec_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b102_exec_used.html</a><br>

<div class="code">
<pre>
734	            _locs_ = _globs_
735	        exec(&quot;&quot;&quot;exec _code_ in _globs_, _locs_&quot;&quot;&quot;)
736	
</pre>
</div>


</div>
</div>

<div id="issue-189">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/cli.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/cli.py</a><br>
    <b>Line number: </b>1306<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1305	            if not db[view_name].exists():
1306	                db.create_view(view_name, &quot;select * from [{}]&quot;.format(csv_table))
1307	
</pre>
</div>


</div>
</div>

<div id="issue-190">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/cli.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/cli.py</a><br>
    <b>Line number: </b>1495<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1494	        path=path,
1495	        sql=&quot;select {} from [{}]&quot;.format(columns, dbtable),
1496	        nl=nl,
</pre>
</div>


</div>
</div>

<div id="issue-191">
<div class="issue-block issue-sev-high">
    <b>hashlib: </b> Use of weak MD5 hash for security. Consider usedforsecurity=False<br>
    <b>Test ID:</b> B324<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/327.html" target="_blank">CWE-327</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/cli.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/cli.py</a><br>
    <b>Line number: </b>1900<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html</a><br>

<div class="code">
<pre>
1899	                        &quot;sha256&quot;: lambda p: hashlib.sha256(stdin_data).hexdigest(),
1900	                        &quot;md5&quot;: lambda p: hashlib.md5(stdin_data).hexdigest(),
1901	                        &quot;size&quot;: lambda p: len(stdin_data),
</pre>
</div>


</div>
</div>

<div id="issue-192">
<div class="issue-block issue-sev-medium">
    <b>exec_used: </b> Use of exec detected.<br>
    <b>Test ID:</b> B102<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/cli.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/cli.py</a><br>
    <b>Line number: </b>2126<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b102_exec_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b102_exec_used.html</a><br>

<div class="code">
<pre>
2125	        globals[import_] = __import__(import_)
2126	    exec(code_o, globals, locals)
2127	    fn = locals[&quot;fn&quot;]
</pre>
</div>


</div>
</div>

<div id="issue-193">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/cli.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/cli.py</a><br>
    <b>Line number: </b>2131<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2130	        db.conn.create_function(&quot;preview_transform&quot;, 1, lambda v: fn(v) if v else v)
2131	        sql = &quot;&quot;&quot;
2132	            select
2133	                [{column}] as value,
2134	                preview_transform([{column}]) as preview
2135	            from [{table}]{where} limit 10
2136	        &quot;&quot;&quot;.format(
2137	            column=columns[0],
</pre>
</div>


</div>
</div>

<div id="issue-194">
<div class="issue-block issue-sev-high">
    <b>hashlib: </b> Use of weak MD5 hash for security. Consider usedforsecurity=False<br>
    <b>Test ID:</b> B324<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/327.html" target="_blank">CWE-327</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/cli.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/cli.py</a><br>
    <b>Line number: </b>2192<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html</a><br>

<div class="code">
<pre>
2191	    &quot;sha256&quot;: lambda p: hashlib.sha256(p.resolve().read_bytes()).hexdigest(),
2192	    &quot;md5&quot;: lambda p: hashlib.md5(p.resolve().read_bytes()).hexdigest(),
2193	    &quot;mode&quot;: lambda p: p.stat().st_mode,
</pre>
</div>


</div>
</div>

<div id="issue-195">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>296<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
295	    ):
296	        assert (filename_or_conn is not None and not memory) or (
297	            filename_or_conn is None and memory
298	        ), &quot;Either specify a filename_or_conn or pass memory=True&quot;
299	        if memory or filename_or_conn == &quot;:memory:&quot;:
</pre>
</div>


</div>
</div>

<div id="issue-196">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>306<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
305	        else:
306	            assert not recreate, &quot;recreate cannot be used with connections, only paths&quot;
307	            self.conn = filename_or_conn
</pre>
</div>


</div>
</div>

<div id="issue-197">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>471<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
470	            where.append(&quot;sql like &#x27;%USING FTS5%&#x27;&quot;)
471	        sql = &quot;select name from sqlite_master where {}&quot;.format(&quot; AND &quot;.join(where))
472	        return [r[0] for r in self.execute(sql).fetchall()]
</pre>
</div>


</div>
</div>

<div id="issue-198">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>559<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
558	        &quot;&quot;&quot;
559	        sql = &quot;select [table], count from {}&quot;.format(self._counts_table_name)
560	        if tables:
</pre>
</div>


</div>
</div>

<div id="issue-199">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>602<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
601	            return fks
602	        assert all(
603	            isinstance(fk, (tuple, list)) for fk in foreign_keys
604	        ), &quot;foreign_keys= should be a list of tuples&quot;
605	        fks = []
</pre>
</div>


</div>
</div>

<div id="issue-200">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>607<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
606	        for tuple_or_list in foreign_keys:
607	            assert len(tuple_or_list) in (
608	                2,
609	                3,
610	            ), &quot;foreign_keys= should be a list of tuple pairs or triples&quot;
611	            if len(tuple_or_list) == 3:
</pre>
</div>


</div>
</div>

<div id="issue-201">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>649<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
648	            if isinstance(extract_column, tuple):
649	                assert False
650	            # Ensure other table exists
</pre>
</div>


</div>
</div>

<div id="issue-202">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>660<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
659	        defaults = defaults or {}
660	        assert all(
661	            n in columns for n in not_null
662	        ), &quot;not_null set {} includes items not in columns {}&quot;.format(
663	            repr(not_null), repr(set(columns.keys()))
664	        )
665	        assert all(
</pre>
</div>


</div>
</div>

<div id="issue-203">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>665<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
664	        )
665	        assert all(
666	            n in columns for n in defaults
667	        ), &quot;defaults set {} includes items not in columns {}&quot;.format(
668	            repr(set(defaults)), repr(set(columns.keys()))
669	        )
670	        validate_column_names(columns.keys())
</pre>
</div>


</div>
</div>

<div id="issue-204">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>788<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
787	        &quot;&quot;&quot;
788	        assert not (
789	            ignore and replace
790	        ), &quot;Use one or the other of ignore/replace, not both&quot;
791	        create_sql = &quot;CREATE VIEW {name} AS {sql}&quot;.format(name=name, sql=sql)
</pre>
</div>


</div>
</div>

<div id="issue-205">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>828<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
827	        # foreign_keys is a list of explicit 4-tuples
828	        assert all(
829	            len(fk) == 4 and isinstance(fk, (list, tuple)) for fk in foreign_keys
830	        ), &quot;foreign_keys must be a list of 4-tuples, (table, column, other_table, other_column)&quot;
831	
</pre>
</div>


</div>
</div>

<div id="issue-206">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>924<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
923	        &quot;Executes ``SELECT count(*) FROM table WHERE ...`` and returns a count.&quot;
924	        sql = &quot;select count(*) from [{}]&quot;.format(self.name)
925	        if where is not None:
</pre>
</div>


</div>
</div>

<div id="issue-207">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>966<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
965	            return
966	        sql = &quot;select {} from [{}]&quot;.format(select, self.name)
967	        if where is not None:
</pre>
</div>


</div>
</div>

<div id="issue-208">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>1268<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
1267	        &quot;&quot;&quot;
1268	        assert self.exists(), &quot;Cannot transform a table that doesn&#x27;t exist yet&quot;
1269	        sqls = self.transform_sql(
</pre>
</div>


</div>
</div>

<div id="issue-209">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>1359<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
1358	        else:
1359	            assert False, &quot;not_null must be a dict or a set or None&quot;
1360	        # defaults=
</pre>
</div>


</div>
</div>

<div id="issue-210">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>1400<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1399	            new_cols.append(to_)
1400	        copy_sql = &quot;INSERT INTO [{new_table}] ({new_cols})\n   SELECT {old_cols} FROM [{old_table}];&quot;.format(
1401	            new_table=new_table_name,
</pre>
</div>


</div>
</div>

<div id="issue-211">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>1469<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1468	        self.db.execute(
1469	            &quot;INSERT OR IGNORE INTO [{lookup_table}] ({lookup_columns}) SELECT DISTINCT {table_cols} FROM [{table}]&quot;.format(
1470	                lookup_table=table,
</pre>
</div>


</div>
</div>

<div id="issue-212">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>1482<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1481	        self.db.execute(
1482	            &quot;UPDATE [{table}] SET [{magic_lookup_column}] = (SELECT id FROM [{lookup_table}] WHERE {where})&quot;.format(
1483	                table=self.name,
</pre>
</div>


</div>
</div>

<div id="issue-213">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>1961<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
1960	        fts_table = self.detect_fts()
1961	        assert fts_table, &quot;Full-text search is not configured for table &#x27;{}&#x27;&quot;.format(
1962	            self.name
1963	        )
1964	        virtual_table_using = self.db[fts_table].virtual_table_using
</pre>
</div>


</div>
</div>

<div id="issue-214">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2051<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2050	        wheres = [&quot;[{}] = ?&quot;.format(pk_name) for pk_name in self.pks]
2051	        sql = &quot;delete from [{table}] where {wheres}&quot;.format(
2052	            table=self.name, wheres=&quot; and &quot;.join(wheres)
</pre>
</div>


</div>
</div>

<div id="issue-215">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2064<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2063	            return self
2064	        sql = &quot;delete from [{}]&quot;.format(self.name)
2065	        if where is not None:
</pre>
</div>


</div>
</div>

<div id="issue-216">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2107<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2106	        args.extend(pk_values)
2107	        sql = &quot;update [{table}] set {sets} where {wheres}&quot;.format(
2108	            table=self.name, sets=&quot;, &quot;.join(sets), wheres=&quot; and &quot;.join(wheres)
</pre>
</div>


</div>
</div>

<div id="issue-217">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2122<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
2121	            # TODO: Test this works (rolls back) - use better exception:
2122	            assert rowcount == 1
2123	        self.last_pk = pk_values[0] if len(pks) == 1 else pk_values
</pre>
</div>


</div>
</div>

<div id="issue-218">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2170<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
2169	        if output is not None:
2170	            assert len(columns) == 1, &quot;output= can only be used with a single column&quot;
2171	            if output not in self.columns_dict:
</pre>
</div>


</div>
</div>

<div id="issue-219">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2184<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2183	            self.db.register_function(convert_value)
2184	            sql = &quot;update [{table}] set {sets}{where};&quot;.format(
2185	                table=self.name,
</pre>
</div>


</div>
</div>

<div id="issue-220">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2300<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2299	                if set_cols:
2300	                    sql2 = &quot;UPDATE [{table}] SET {pairs} WHERE {wheres}&quot;.format(
2301	                        table=self.name,
</pre>
</div>


</div>
</div>

<div id="issue-221">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2536<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
2535	            raise PrimaryKeyRequired(&quot;upsert() requires a pk&quot;)
2536	        assert not (hash_id and pk), &quot;Use either pk= or hash_id=&quot;
2537	        if hash_id:
</pre>
</div>


</div>
</div>

<div id="issue-222">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2540<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
2539	
2540	        assert not (
2541	            ignore and replace
2542	        ), &quot;Use either ignore=True or replace=True, not both&quot;
2543	        all_columns = []
</pre>
</div>


</div>
</div>

<div id="issue-223">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2555<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
2554	        num_columns = len(first_record.keys())
2555	        assert (
2556	            num_columns &lt;= SQLITE_MAX_VARS
2557	        ), &quot;Rows can have a maximum of {} columns&quot;.format(SQLITE_MAX_VARS)
2558	        batch_size = max(1, min(batch_size, SQLITE_MAX_VARS // num_columns))
</pre>
</div>


</div>
</div>

<div id="issue-224">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2562<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2561	        if truncate and self.exists():
2562	            self.db.execute(&quot;DELETE FROM [{}];&quot;.format(self.name))
2563	        for chunk in chunks(itertools.chain([first_record], records), batch_size):
</pre>
</div>


</div>
</div>

<div id="issue-225">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2703<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
2702	        # lookups is a dictionary - all columns will be used for a unique index
2703	        assert isinstance(column_values, dict)
2704	        if self.exists():
</pre>
</div>


</div>
</div>

<div id="issue-226">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2761<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
2760	        if lookup is not None:
2761	            assert record_or_iterable is None, &quot;Provide lookup= or record, not both&quot;
2762	        else:
</pre>
</div>


</div>
</div>

<div id="issue-227">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2763<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
2762	        else:
2763	            assert record_or_iterable is not None, &quot;Provide lookup= or record, not both&quot;
2764	        tables = list(sorted([self.name, other_table.name]))
</pre>
</div>


</div>
</div>

<div id="issue-228">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2834<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2833	        num_null = db.execute(
2834	            &quot;select count(*) from [{}] where [{}] is null&quot;.format(table, column)
2835	        ).fetchone()[0]
</pre>
</div>


</div>
</div>

<div id="issue-229">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2837<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2836	        num_blank = db.execute(
2837	            &quot;select count(*) from [{}] where [{}] = &#x27;&#x27;&quot;.format(table, column)
2838	        ).fetchone()[0]
</pre>
</div>


</div>
</div>

<div id="issue-230">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2840<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2839	        num_distinct = db.execute(
2840	            &quot;select count(distinct [{}]) from [{}]&quot;.format(column, table)
2841	        ).fetchone()[0]
</pre>
</div>


</div>
</div>

<div id="issue-231">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2846<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2845	            value = db.execute(
2846	                &quot;select [{}] from [{}] limit 1&quot;.format(column, table)
2847	            ).fetchone()[0]
</pre>
</div>


</div>
</div>

<div id="issue-232">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2853<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2852	                for r in db.execute(
2853	                    &quot;select [{}], count(*) from [{}] group by [{}] order by count(*) desc, [{}] limit {}&quot;.format(
2854	                        column, table, column, column, common_limit
</pre>
</div>


</div>
</div>

<div id="issue-233">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2866<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2865	                    for r in db.execute(
2866	                        &quot;select [{}], count(*) from [{}] group by [{}] order by count(*), [{}] desc limit {}&quot;.format(
2867	                            column, table, column, column, common_limit
</pre>
</div>


</div>
</div>

<div id="issue-234">
<div class="issue-block issue-sev-high">
    <b>hashlib: </b> Use of weak SHA1 hash for security. Consider usedforsecurity=False<br>
    <b>Test ID:</b> B324<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/327.html" target="_blank">CWE-327</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2926<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html</a><br>

<div class="code">
<pre>
2925	def _hash(record):
2926	    return hashlib.sha1(
2927	        json.dumps(record, separators=(&quot;,&quot;, &quot;:&quot;), sort_keys=True, default=repr).encode(
2928	            &quot;utf8&quot;
2929	        )
2930	    ).hexdigest()
2931	
</pre>
</div>


</div>
</div>

<div id="issue-235">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/db.py</a><br>
    <b>Line number: </b>2946<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
2945	    for column in columns:
2946	        assert (
2947	            &quot;[&quot; not in column and &quot;]&quot; not in column
2948	        ), &quot;&#x27;[&#x27; and &#x27;]&#x27; cannot be used in column names&quot;
</pre>
</div>


</div>
</div>

<div id="issue-236">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/utils.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/sqlite_utils/utils.py</a><br>
    <b>Line number: </b>67<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
66	    # https://www.sqlite.org/datatype3.html#determination_of_column_affinity
67	    assert isinstance(column_type, str)
68	    column_type = column_type.upper().strip()
</pre>
</div>


</div>
</div>

<div id="issue-237">
<div class="issue-block issue-sev-low">
    <b>assert_used: </b> Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.<br>
    <b>Test ID:</b> B101<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/tabulate.py" target="_blank">cloudgoat/scenarios/vulnerable_lambda/terraform/lambda_source_code/policy_applier_lambda2_src/tabulate.py</a><br>
    <b>Line number: </b>1599<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b101_assert_used.html</a><br>

<div class="code">
<pre>
1598	    if colalign is not None:
1599	        assert isinstance(colalign, Iterable)
1600	        for idx, align in enumerate(colalign):
</pre>
</div>


</div>
</div>

</div>

</body>
</html>
